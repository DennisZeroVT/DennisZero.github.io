<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Songs</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: url('backdrop.png') no-repeat center center fixed;
      background-size: cover;
      font-family: Verdana, Arial, sans-serif;
      color: white;
      padding-bottom: 100px;
    }

    .sidebar {
      width: 200px;
      background: rgba(43, 33, 64, 0.85);
      height: 100vh;
      padding: 20px;
      border-right: 3px solid #ffffff33;
      position: fixed;
      top: 0; left: 0;
      backdrop-filter: blur(2px);
      z-index: 100;
    }
    .sidebar button {
      width: 100%; padding: 10px; margin-bottom: 12px;
      background: #4a3568; color: #d6c8ff;
      border: 2px solid #ffffff55; font-weight: bold;
      cursor: pointer; text-align: left;
      box-shadow: 2px 2px 4px #00000055;
    }
    .sidebar button:hover { background: #6a52a0; border-color: #ffffffaa; }

    .top-nav {
      display: none;
      background: rgba(43, 33, 64, 0.95);
      border-bottom: 3px solid #ffffff33;
      padding: 10px; position: sticky; top: 0; z-index: 100;
      backdrop-filter: blur(4px); gap: 8px; flex-wrap: wrap;
    }
    .top-nav button {
      flex: 1; min-width: 70px; padding: 8px 6px;
      background: #4a3568; color: #d6c8ff;
      border: 2px solid #ffffff55; font-weight: bold;
      cursor: pointer; font-size: 12px;
    }
    .top-nav button:hover { background: #6a52a0; }

    .content-wrapper { margin-left: 200px; padding: 20px; }
    .main-panel {
      background: rgba(0,0,0,0.65);
      border: 2px solid #ffffff33;
      padding: 20px;
      backdrop-filter: blur(4px);
      box-shadow: 0 0 10px #000000aa;
      border-radius: 10px;
    }
    .main-panel h2 { margin-bottom: 6px; }
    .section-desc { color: #a08ccc; font-size: 13px; margin-bottom: 20px; }
    .section-title {
      font-size: 11px; text-transform: uppercase;
      letter-spacing: 3px; color: #9b7fcc;
      margin: 0 0 16px; padding-bottom: 8px;
      border-bottom: 1px solid #ffffff22;
    }

    /* ‚îÄ‚îÄ SONG CARDS ‚îÄ‚îÄ */
    .songs-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
      gap: 16px;
    }
    .song-card {
      background: rgba(0,0,0,0.5);
      border: 2px solid #ffffff22;
      border-radius: 12px;
      overflow: hidden;
      backdrop-filter: blur(3px);
      box-shadow: 0 0 12px #00000077;
      transition: border-color 0.25s, transform 0.25s, box-shadow 0.25s;
      cursor: pointer;
    }
    .song-card:hover {
      border-color: #8b5cf688;
      transform: translateY(-3px);
      box-shadow: 0 6px 24px #8b5cf633;
    }
    .song-cover {
      width: 100%; aspect-ratio: 1;
      background: linear-gradient(135deg, #3a2060, #6a3fa0);
      display: flex; align-items: center; justify-content: center;
      font-size: 56px;
      position: relative; overflow: hidden;
    }
    /* KEY FIX: image sits absolutely on top, emoji is underneath */
    .song-cover .cover-img {
      position: absolute; inset: 0;
      width: 100%; height: 100%; object-fit: cover;
      display: block;
    }
    .card-hover-layer {
      position: absolute; inset: 0;
      background: rgba(0,0,0,0.45);
      display: flex; align-items: center; justify-content: center;
      opacity: 0; transition: opacity 0.2s;
      flex-direction: column; gap: 8px; z-index: 2;
    }
    .song-card:hover .card-hover-layer { opacity: 1; }
    .card-open-btn {
      width: 52px; height: 52px; border-radius: 50%;
      background: #8b5cf6; border: none; color: white; font-size: 20px;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 4px 16px #00000088;
    }
    .card-hover-layer span { font-size: 10px; color: #d6c8ff; letter-spacing: 1.5px; text-transform: uppercase; }
    .card-body { padding: 14px; }
    .song-name { font-size: 15px; font-weight: bold; margin-bottom: 4px; }
    .song-meta { font-size: 11px; color: #9b7fcc; margin-bottom: 8px; }
    .song-desc { font-size: 12px; color: #cccccc; line-height: 1.6; }
    .song-badges { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 10px; }
    .badge { font-size: 10px; padding: 3px 8px; border-radius: 20px; font-weight: bold; letter-spacing: 0.5px; }
     /* custom bagdes are here*/
    .badge-released { background: #1a3a1a; color: #6ddc6d; border: 1px solid #6ddc6d55; }
    .badge-spotify  { background: #0a2a1a; color: #1db954; border: 1px solid #1db95455; }
    .badge-apple  { background: #f94949; color: #ffffff; border: 1px solid #ffffff55; }
    .badge-tidal  { background: #1a1a1a; color: #ffffff; border: 1px solid #ffffff55; }
    .badge-amazon { background: #007ea8; color: #ffffff; border: 1px solid #ffffff55; }
    .badge-youtube { background: #ff0000; color: #ffffff; border: 1px solid #ffffff55; }
    .badge-soundcloud { background: #ff5500; color: #ffffff; border: 1px solid #ffffff55; }
    .badge-deezer { background: #ffffff; color: #1db954; border: 1px solid #1db95455; }

    /* ‚îÄ‚îÄ FULLSCREEN OVERLAY ‚îÄ‚îÄ */
    .song-overlay {
      position: fixed; inset: 0; z-index: 500;
      display: flex; opacity: 0; pointer-events: none;
      transition: opacity 0.4s ease;
    }
    .song-overlay.open { opacity: 1; pointer-events: all; }
    .song-overlay::before {
      content: ''; position: absolute; inset: 0;
      background: rgba(6, 3, 16, 0.96); backdrop-filter: blur(12px);
    }
    .overlay-inner {
      position: relative; display: flex; width: 100%;
      transform: translateY(28px);
      transition: transform 0.45s cubic-bezier(0.22, 1, 0.36, 1);
    }
    .song-overlay.open .overlay-inner { transform: translateY(0); }

    /* left panel */
    .ov-left {
      width: 360px; min-width: 300px; flex-shrink: 0;
      border-right: 1px solid #ffffff11;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      padding: 40px 28px; gap: 22px;
      background: rgba(0,0,0,0.25);
    }
    .ov-cover {
      width: 220px; height: 220px; border-radius: 16px;
      background: linear-gradient(135deg, #3a2060, #6a3fa0);
      display: flex; align-items: center; justify-content: center;
      font-size: 76px;
      box-shadow: 0 8px 40px #00000099;
      overflow: hidden; flex-shrink: 0; position: relative;
    }
    /* KEY FIX: overlay cover image */
    .ov-cover .cover-img {
      position: absolute; inset: 0;
      width: 100%; height: 100%; object-fit: cover;
      border-radius: 16px; display: block;
    }
    .ov-cover .cover-emoji { position: relative; z-index: 0; }
    .ov-cover.spinning { animation: spin-cover 8s linear infinite; }
    @keyframes spin-cover { to { transform: rotate(360deg); } }

    .ov-title-block { text-align: center; }
    .ov-track-name { font-size: 20px; font-weight: bold; }
    .ov-track-artist { font-size: 12px; color: #9b7fcc; margin-top: 4px; }

    .ov-progress-area { width: 100%; }
    .ov-bar { width: 100%; height: 4px; background: #ffffff22; border-radius: 2px; cursor: pointer; margin-bottom: 6px; }
    .ov-bar-fill { height: 100%; border-radius: 2px; width: 0%; background: linear-gradient(90deg, #8b5cf6, #c084fc); transition: width 0.4s linear; pointer-events: none; }
    .ov-times { display: flex; justify-content: space-between; font-size: 10px; color: #9b7fcc; }

    .ov-controls { display: flex; align-items: center; gap: 14px; }
    .ov-btn { background: rgba(255,255,255,0.08); border: 1px solid #ffffff33; color: white; width: 38px; height: 38px; border-radius: 50%; cursor: pointer; font-size: 15px; display: flex; align-items: center; justify-content: center; transition: background 0.2s; }
    .ov-btn:hover { background: rgba(255,255,255,0.2); }
    .ov-play { width: 52px; height: 52px; border-radius: 50%; background: linear-gradient(135deg, #8b5cf6, #6d28d9); border: none; color: white; font-size: 22px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 20px #8b5cf666; transition: transform 0.15s; }
    .ov-play:hover { transform: scale(1.08); }

    .ov-volume { display: flex; align-items: center; gap: 8px; width: 100%; }
    .ov-volume span { font-size: 14px; }
    .ov-volume input[type=range] { flex: 1; -webkit-appearance: none; height: 3px; background: #ffffff33; border-radius: 2px; outline: none; cursor: pointer; }
    .ov-volume input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; border-radius: 50%; background: #a78bfa; cursor: pointer; }

    /* right panel */
    .ov-right { flex: 1; overflow-y: auto; padding: 50px 44px; display: flex; flex-direction: column; gap: 24px; }
    .ov-close { position: absolute; top: 20px; right: 24px; background: rgba(255,255,255,0.08); border: 1px solid #ffffff33; color: white; width: 40px; height: 40px; border-radius: 50%; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s; z-index: 10; }
    .ov-close:hover { background: rgba(255,255,255,0.22); }
    .ov-header-label { font-size: 10px; text-transform: uppercase; letter-spacing: 3px; color: #7c5cbf; margin-bottom: 8px; }
    .ov-header-title { font-size: 30px; font-weight: bold; line-height: 1.2; margin-bottom: 4px; }
    .ov-header-year  { font-size: 13px; color: #9b7fcc; margin-bottom: 12px; }
    .ov-badges { display: flex; gap: 8px; flex-wrap: wrap; }
    .ov-block { background: rgba(255,255,255,0.04); border: 1px solid #ffffff11; border-radius: 12px; padding: 20px 22px; }
    .ov-block-title { font-size: 10px; text-transform: uppercase; letter-spacing: 2px; color: #8b5cf6; margin-bottom: 12px; }
    .ov-block p { font-size: 13px; line-height: 1.9; color: #d6c8ff; }

    /* ‚îÄ‚îÄ STREAMING LINKS ‚îÄ‚îÄ */
    .streaming-links { display: flex; flex-wrap: wrap; gap: 10px; }
    .stream-btn {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 10px 16px; border-radius: 8px;
      font-size: 12px; font-weight: bold; font-family: Verdana, sans-serif;
      text-decoration: none; color: white;
      border: 1px solid transparent;
      transition: transform 0.15s, filter 0.15s;
      white-space: nowrap;
    }
    .stream-btn:hover { transform: translateY(-2px); filter: brightness(1.15); }
    .stream-btn svg { width: 15px; height: 15px; flex-shrink: 0; }
    .s-spotify { background: #1db954; }
    .s-apple   { background: #fc3c44; }
    .s-tidal   { background: #1a1a1a; border-color: #ffffff33; }
    .s-amazon  { background: #00a8e0; }
    .s-youtube { background: #ff0000; }

    .spotify-embed iframe { border-radius: 12px; display: block; margin-top: 10px; }

    /* ‚îÄ‚îÄ BOTTOM PLAYER ‚îÄ‚îÄ */
    .universal-player {
      position: fixed; bottom: 0; left: 0; right: 0; height: 88px;
      background: rgba(18, 10, 35, 0.97); border-top: 2px solid #ffffff22;
      backdrop-filter: blur(20px); display: flex; align-items: center;
      padding: 0 24px; gap: 20px; z-index: 200;
      box-shadow: 0 -4px 30px #00000099;
      transition: transform 0.35s ease, opacity 0.35s ease;
    }
    .universal-player.hidden { transform: translateY(100%); opacity: 0; pointer-events: none; }
    .up-track { display: flex; align-items: center; gap: 12px; width: 220px; min-width: 0; flex-shrink: 0; }
    .up-disc {
      width: 50px; height: 50px; border-radius: 8px;
      background: linear-gradient(135deg, #3a2060, #6a3fa0);
      display: flex; align-items: center; justify-content: center;
      font-size: 22px; flex-shrink: 0; overflow: hidden; position: relative;
    }
    /* KEY FIX: bottom bar disc image */
    .up-disc .cover-img {
      position: absolute; inset: 0;
      width: 100%; height: 100%; object-fit: cover;
      border-radius: 8px; display: block;
    }
    .up-disc .cover-emoji { position: relative; z-index: 0; }
    .up-disc.spinning { animation: spin-disc 6s linear infinite; }
    @keyframes spin-disc { to { transform: rotate(360deg); } }
    .up-track-name { font-size: 13px; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .up-track-artist { font-size: 11px; color: #9b7fcc; margin-top: 2px; }
    .up-idle { color: #555; font-size: 13px; font-style: italic; }
    .up-center { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 6px; }
    .up-controls { display: flex; align-items: center; gap: 12px; }
    .up-btn { background: none; border: none; color: #cccccc; cursor: pointer; font-size: 16px; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: color 0.15s, background 0.15s; }
    .up-btn:hover { color: white; background: rgba(255,255,255,0.1); }
    .up-play { width: 42px; height: 42px; background: linear-gradient(135deg, #8b5cf6, #6d28d9); border: none; color: white; border-radius: 50%; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.15s; box-shadow: 0 2px 12px #8b5cf655; }
    .up-play:hover { transform: scale(1.08); }
    .up-progress-row { width: 100%; display: flex; align-items: center; gap: 8px; font-size: 10px; color: #9b7fcc; }
    .up-bar { flex: 1; height: 4px; background: #ffffff22; border-radius: 2px; cursor: pointer; }
    .up-bar-fill { height: 100%; border-radius: 2px; width: 0%; background: linear-gradient(90deg, #8b5cf6, #c084fc); transition: width 0.4s linear; pointer-events: none; }
    .up-right { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
    .up-right span { font-size: 14px; }
    .up-right input[type=range] { width: 90px; -webkit-appearance: none; height: 3px; background: #ffffff33; border-radius: 2px; outline: none; cursor: pointer; }
    .up-right input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; border-radius: 50%; background: #a78bfa; cursor: pointer; }

    /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
    @media (min-width: 701px) and (max-width: 960px) {
      .sidebar { width: 160px; }
      .content-wrapper { margin-left: 160px; padding: 14px; }
      .ov-left { width: 280px; min-width: 240px; padding: 28px 18px; }
      .ov-cover { width: 180px; height: 180px; }
      .ov-right { padding: 36px 24px; }
    }
    @media (max-width: 700px) {
      .sidebar { display: none; }
      .top-nav { display: flex; }
      .content-wrapper { margin-left: 0; padding: 12px; }
      .up-track { width: 130px; }
      .up-right { display: none; }
      .universal-player { padding: 0 12px; gap: 12px; }
      .overlay-inner { flex-direction: column; overflow-y: auto; }
      .ov-left { width: 100%; min-width: unset; border-right: none; border-bottom: 1px solid #ffffff11; padding: 28px 18px; gap: 16px; }
      .ov-cover { width: 160px; height: 160px; font-size: 56px; }
      .ov-right { padding: 24px 16px; }
      .ov-header-title { font-size: 22px; }
    }
  </style>
</head>
<body>

<nav class="top-nav">
  <button onclick="location.href='index.html'">Home</button>
  <button onclick="location.href='songs.html'">Songs</button>
</nav>

<div class="sidebar">
  <button onclick="location.href='index.html'">Home</button>
  <button onclick="location.href='songs.html'">Songs</button>
</div>

<div class="content-wrapper">
  <div class="main-panel">
    <h2>My Songs</h2>
    <p class="section-desc">Click a song to hear it and read the story behind it.</p>

    <div class="section-title" style="margin-top:18px;">Released</div>
    <div class="songs-grid">

      <!-- SNOWFALL CARD -->
      <div class="song-card" onclick="openSong('snowfall')">
        <div class="song-cover">
          üå®Ô∏è
          <img class="cover-img" src="snowfall.png" alt="Snowfall" onerror="this.remove()">
          <div class="card-hover-layer">
            <div class="card-open-btn">‚ñ∂</div>
            <span>Open</span>
          </div>
        </div>
        <div class="card-body">
          <div class="song-name">Snowfall</div>
          <div class="song-meta">2025</div>
          <div class="song-desc">My first ever released song, written for a friend.</div>
          <!--
            SNOWFALL BADGES
            To add more badges, simply add more <span> elements with the appropriate class (e.g. badge-spotify) and label (e.g. Spotify).
      -->
          <div class="song-badges">
            <span class="badge badge-released">Released</span>
            <span class="badge badge-spotify">Spotify</span>
            <span class="badge badge-apple">Apple Music</span>
            <span class="badge badge-tidal">Tidal</span>
            <span class="badge badge-amazon">Amazon</span>
            <span class="badge badge-youtube">YouTube Music</span>
          </div>
        </div>
      </div>

      <!--
        TO ADD A NEW SONG CARD:
        1. Copy the card block above
        2. Change onclick to a new key e.g. openSong('mysong')
        3. Update the img src (or remove it for emoji-only)
        4. Add the song's data to the SONGS object in the script below
      -->

    </div>
  </div>
</div>

<!-- FULLSCREEN OVERLAY -->
<div class="song-overlay" id="songOverlay">
  <button class="ov-close" onclick="closeOverlay()">‚úï</button>
  <div class="overlay-inner">

    <div class="ov-left">
      <div class="ov-cover" id="ovCover">
        <span class="cover-emoji" id="ovEmoji"></span>
      </div>
      <div class="ov-title-block">
        <div class="ov-track-name" id="ovName"></div>
        <div class="ov-track-artist" id="ovArtist"></div>
      </div>
      <div class="ov-progress-area">
        <div class="ov-bar" id="ovBar"><div class="ov-bar-fill" id="ovFill"></div></div>
        <div class="ov-times"><span id="ovCur">0:00</span><span id="ovDur">0:00</span></div>
      </div>
      <div class="ov-controls">
        <button class="ov-btn" onclick="seekBack()">‚èÆ</button>
        <button class="ov-play" id="ovPlayBtn" onclick="togglePlay()">‚ñ∂</button>
        <button class="ov-btn" onclick="seekFwd()">‚è≠</button>
      </div>
      <div class="ov-volume">
        <span>üîä</span>
        <input type="range" id="ovVol" min="0" max="1" step="0.01" value="0.7" oninput="audio.volume=this.value">
      </div>
    </div>

    <div class="ov-right" id="ovRight"></div>
  </div>
</div>

<!-- BOTTOM PLAYER -->
<audio id="mainAudio" preload="auto"></audio>

<div class="universal-player" id="universalPlayer">
  <div class="up-track">
    <div class="up-disc" id="upDisc">
      <span class="cover-emoji" id="upEmoji">üéµ</span>
    </div>
    <div id="upTrackText"><div class="up-idle">No song selected</div></div>
  </div>
  <div class="up-center">
    <div class="up-controls">
      <button class="up-btn" onclick="seekBack()">‚èÆ</button>
      <button class="up-play" id="upPlayBtn" onclick="togglePlay()">‚ñ∂</button>
      <button class="up-btn" onclick="seekFwd()">‚è≠</button>
    </div>
    <div class="up-progress-row">
      <span id="upCur">0:00</span>
      <div class="up-bar" id="upBar"><div class="up-bar-fill" id="upFill"></div></div>
      <span id="upDur">0:00</span>
    </div>
  </div>
  <div class="up-right">
    <span>üîä</span>
    <input type="range" id="upVol" min="0" max="1" step="0.01" value="0.7" oninput="audio.volume=this.value">
  </div>
</div>

<script>
/* ================================================================
   SONG DATA
   coverImg: filename of your cover image (e.g. 'snowfall.png')
             set to null to use the emoji only
   streaming: set any platform to null to hide it,
              or paste the full URL to show a button for it.
              Spotify also shows an embed player when provided.
================================================================ */
const SONGS = {
  snowfall: {
    name:     'Snowfall',
    artist:   'Dennis van Wijngaarden',
    year:     '2025',
    src:      'Snowfall.mp3',
    cover:    'üå®Ô∏è',          // emoji shown if image missing/fails
    coverImg: 'snowfall.png', // ‚Üê your image file. set null if none.
    badges:   ['Released', 'Spotify', 'Apple Music', 'Tidal', 'Amazon', 'YouTube Music', ], // badges to show on card (Spotify, Apple Music, Tidal, Amazon, YouTube, etc.)

    streaming: {
      spotify:  'https://open.spotify.com/embed/track/0TxrNlfNSlwuncbt0wpVH6?utm_source=generator',
      apple:    'https://music.apple.com/be/album/snowfall-single/1840250772?l=nl',  // e.g. 'https://music.apple.com/album/...'
      tidal:    null,  // e.g. 'https://tidal.com/browse/track/...'
      amazon:   null,  // e.g. 'https://music.amazon.com/albums/...'
      youtube:  null,  // e.g. 'https://music.youtube.com/watch?v=...'
    },

    about:
      `Snowfall was written for my friend Erik, also known as eri_k416. ` +
      `It's built around his character Viona ‚Äî a quiet, wintry figure that ` +
      `inspired the whole mood of the track.`,

    thoughts:
      `This was the first time I ever wrote lyrics for a song. I didn't plan ` +
      `it that way ‚Äî I just wanted to make something for Erik and the words came ` +
      `naturally. I remember sitting with the melody for a long time before anything ` +
      `clicked. When it finally did, it felt like the song wrote itself.`,

    behindTheScenes:
      `I was using Studio One at the time. The arrangement started with just a piano ` +
      `line and some light percussion. The winter atmosphere came from layered pads ` +
      `and a lot of reverb on everything. I wanted it to feel like you were standing ` +
      `outside in the cold, watching snow fall slowly ‚Äî calm but a little melancholic.`
  }

  /*
  ,
  mysong: {
    name:     'My Song Title',
    artist:   'Dennis van Wijngaarden',
    year:     '2025',
    src:      'MySong.mp3',
    cover:    'üéµ',
    coverImg: 'mycover.png',  // or null
    badges:   ['Released'],
    streaming: {
      spotify: null,
      apple:   null,
      tidal:   null,
      amazon:  null,
      youtube: null,
    },
    about:           'What this song is about...',
    thoughts:        'Your personal thoughts...',
    behindTheScenes: 'How you made it...'
  }
  */
};

/* ‚îÄ‚îÄ Streaming platform config (icons + colours) ‚îÄ‚îÄ */
const PLATFORMS = [
  { key:'spotify', label:'Spotify',       cls:'s-spotify', icon:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>' },
  { key:'apple',   label:'Apple Music',   cls:'s-apple',   icon:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M23.994 6.124a9.23 9.23 0 00-.24-2.19c-.317-1.31-1.062-2.31-2.18-3.043a5.022 5.022 0 00-1.877-.726 10.496 10.496 0 00-1.564-.15c-.04-.003-.083-.01-.124-.013H5.986c-.152.01-.303.017-.455.026C4.786.07 4.043.15 3.34.428 2.004.958 1.04 1.88.475 3.208a8.178 8.178 0 00-.408 1.748C.025 5.35.01 5.748.005 6.146 0 6.252 0 6.358 0 6.464V17.54c0 .106 0 .211.003.317.004.398.02.796.062 1.19.077.7.214 1.334.49 1.944.615 1.35 1.648 2.29 3.04 2.81a7.924 7.924 0 001.655.355c.526.065 1.056.09 1.585.103C6.94 23.997 6.942 24 6.948 24H17.05c.007 0 .013-.003.02-.003.528-.012 1.057-.038 1.584-.103a7.915 7.915 0 001.655-.355c1.394-.52 2.428-1.46 3.04-2.81.277-.61.413-1.244.491-1.944.043-.394.058-.792.063-1.19.003-.106.003-.211.003-.317V6.464c0-.106 0-.212-.003-.317zM13.6 7.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5-.672 1.5-1.5 1.5S13.6 8.328 13.6 7.5zm-5 8.25c0 1.243-1.007 2.25-2.25 2.25S4.1 17.243 4.1 16s1.007-2.25 2.25-2.25c.396 0 .768.103 1.09.284V9l6.56-1.5v5.266A2.254 2.254 0 0112.35 16c0 1.243-1.007 2.25-2.25 2.25S7.85 17.243 7.85 16a2.25 2.25 0 012.25-2.25c.396 0 .769.103 1.09.284v-3.47L8 11.43V15.75z"/></svg>' },
  { key:'tidal',   label:'Tidal',         cls:'s-tidal',   icon:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12.012 3.992L8.008 7.996 4.004 3.992 0 7.996l4.004 4.004 4.004-4.004 4.004 4.004 4.004-4.004L19.996 12l4.004-4.004-4.004-4.004-4.004 4.004-3.98-4.004zM8.008 16.004l-4.004-4.004L0 16.004 4.004 20l4.004-4.004z"/></svg>' },
  { key:'amazon',  label:'Amazon Music',  cls:'s-amazon',  icon:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M13.958 10.09c0 1.232.029 2.256-.591 3.351-.502.891-1.301 1.438-2.186 1.438-1.214 0-1.922-.924-1.922-2.292 0-2.692 2.415-3.182 4.7-3.182v.685zm3.186 7.705c-.209.189-.512.201-.745.076-1.047-.871-1.234-1.276-1.814-2.106-1.734 1.768-2.962 2.297-5.209 2.297-2.66 0-4.731-1.642-4.731-4.927 0-2.565 1.391-4.309 3.37-5.164 1.715-.754 4.11-.891 5.942-1.098v-.41c0-.753.06-1.642-.383-2.294-.385-.579-1.124-.82-1.775-.82-1.205 0-2.277.618-2.54 1.897-.054.285-.261.567-.547.582l-3.065-.333c-.259-.056-.548-.266-.472-.66C5.87 1.846 8.417.992 10.708.992c1.174 0 2.707.311 3.633 1.199 1.174 1.098 1.062 2.563 1.062 4.162v3.77c0 1.134.47 1.632.912 2.245.155.218.189.479-.008.642-.494.412-1.37 1.176-1.853 1.606l-.3-.821zM21.245 19.873c-2.971 2.232-7.277 3.418-10.983 3.418-5.196 0-9.874-1.92-13.415-5.116-.278-.253-.029-.597.304-.401C1.224 20.063 6.147 21.612 11.262 21.612c3.54 0 7.43-.734 11.011-2.255.482-.204.887.317.451.698l-.479.218zm1.352-1.544c-.381-.488-2.526-.232-3.489-.116-.293.036-.338-.219-.075-.403 1.711-1.202 4.517-.855 4.845-.452.327.403-.086 3.205-1.691 4.543-.246.207-.482.097-.373-.176.363-.896 1.165-2.909.783-3.396z"/></svg>' },
  { key:'youtube', label:'YouTube Music', cls:'s-youtube', icon:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M23.495 6.205a3.007 3.007 0 00-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 00.527 6.205a31.247 31.247 0 00-.522 5.805 31.247 31.247 0 00.522 5.783 3.007 3.007 0 002.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 002.088-2.088 31.247 31.247 0 00.5-5.783 31.247 31.247 0 00-.5-5.805zM9.609 15.601V8.408l6.264 3.602z"/></svg>' },
];

/* ================================================================
   AUDIO ENGINE
================================================================ */
const audio = document.getElementById('mainAudio');
audio.volume = 0.7;
let isPlaying = false, currentKey = null, overlayOpen = false;

function fmt(s) {
  if (!s || isNaN(s)) return '0:00';
  const m = Math.floor(s/60), sec = Math.floor(s%60);
  return m + ':' + (sec<10?'0':'') + sec;
}

function setPlaying(state) {
  isPlaying = state;
  const icon = state ? '‚è∏' : '‚ñ∂';
  document.getElementById('ovPlayBtn').textContent = icon;
  document.getElementById('upPlayBtn').textContent = icon;
  document.getElementById('ovCover').classList.toggle('spinning', state);
  document.getElementById('upDisc').classList.toggle('spinning', state);
}

function togglePlay() {
  if (!audio.src) return;
  if (isPlaying) { audio.pause(); setPlaying(false); }
  else { audio.play().then(()=>setPlaying(true)).catch(()=>{}); }
}

function seekBack() { audio.currentTime = Math.max(0, audio.currentTime - 10); }
function seekFwd()  { audio.currentTime = Math.min(audio.duration||0, audio.currentTime + 10); }

function barSeek(e, el) {
  if (!audio.duration) return;
  const r = el.getBoundingClientRect();
  audio.currentTime = ((e.clientX - r.left) / r.width) * audio.duration;
}
document.getElementById('ovBar').addEventListener('click', e => barSeek(e, document.getElementById('ovBar')));
document.getElementById('upBar').addEventListener('click', e => barSeek(e, document.getElementById('upBar')));

audio.addEventListener('timeupdate', () => {
  if (!audio.duration) return;
  const pct = (audio.currentTime / audio.duration * 100) + '%';
  document.getElementById('ovFill').style.width = pct;
  document.getElementById('upFill').style.width = pct;
  document.getElementById('ovCur').textContent  = fmt(audio.currentTime);
  document.getElementById('upCur').textContent  = fmt(audio.currentTime);
});
audio.addEventListener('loadedmetadata', () => {
  const d = fmt(audio.duration);
  document.getElementById('ovDur').textContent = d;
  document.getElementById('upDur').textContent = d;
});
audio.addEventListener('ended', () => {
  setPlaying(false);
  ['ovFill','upFill'].forEach(id => document.getElementById(id).style.width = '0%');
});

/* ================================================================
   COVER HELPER ‚Äî sets emoji + image (with onerror fallback)
================================================================ */
function applyCover(container, emojiEl, song) {
  // Remove any previously injected image
  container.querySelectorAll('.cover-img').forEach(i => i.remove());
  if (emojiEl) emojiEl.textContent = song.cover;

  if (song.coverImg) {
    const img = document.createElement('img');
    img.className = 'cover-img';
    img.src = song.coverImg;
    img.alt = song.name;
    img.onerror = () => img.remove(); // graceful fallback to emoji
    container.appendChild(img);
  }
}

/* ================================================================
   OVERLAY
================================================================ */
function openSong(key) {
  const song = SONGS[key];
  if (!song) return;

  if (currentKey !== key) {
    currentKey = key;
    audio.src = song.src;
    audio.load();
    audio.play().then(()=>setPlaying(true)).catch(()=>setPlaying(false));
  }

  // Cover in overlay
  applyCover(document.getElementById('ovCover'), document.getElementById('ovEmoji'), song);
  // Cover in bottom bar
  applyCover(document.getElementById('upDisc'), document.getElementById('upEmoji'), song);

  document.getElementById('ovName').textContent   = song.name;
  document.getElementById('ovArtist').textContent = song.artist;
  document.getElementById('ovVol').value = audio.volume;

  document.getElementById('upTrackText').innerHTML = `
    <div class="up-track-name">${song.name}</div>
    <div class="up-track-artist">${song.artist}</div>`;

  // Badges
  const badgeMap = { Released:'badge-released', Spotify:'badge-spotify', 'Apple Music':'badge-apple', Tidal:'badge-tidal', Amazon:'badge-amazon', 'YouTube Music':'badge-youtube' }; 
  const badgesHTML = (song.badges||[]).map(b=>`<span class="badge ${badgeMap[b]||''}">${b}</span>`).join('');

  // Streaming buttons + optional Spotify embed
  const links = song.streaming || {};
  const streamBtns = PLATFORMS.filter(p => links[p.key]).map(p =>
    `<a class="stream-btn ${p.cls}" href="${links[p.key]}" target="_blank" rel="noopener">${p.icon} ${p.label}</a>`
  ).join('');

  const spotifyEmbed = links.spotify ? `
    <div class="ov-block spotify-embed">
      <div class="ov-block-title">Spotify Preview</div>
      <iframe src="${links.spotify}" width="100%" height="152" frameBorder="0"
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
        loading="lazy"></iframe>
    </div>` : '';

  const streamBlock = streamBtns ? `
    <div class="ov-block">
      <div class="ov-block-title">Listen On</div>
      <div class="streaming-links">${streamBtns}</div>
    </div>
    ${spotifyEmbed}` : '';

  document.getElementById('ovRight').innerHTML = `
    <div>
      <div class="ov-header-label">Song</div>
      <div class="ov-header-title">${song.name}</div>
      <div class="ov-header-year">${song.year}</div>
      <div class="ov-badges">${badgesHTML}</div>
    </div>
    <div class="ov-block">
      <div class="ov-block-title">About</div>
      <p>${song.about}</p>
    </div>
    <div class="ov-block">
      <div class="ov-block-title">My Thoughts</div>
      <p>${song.thoughts}</p>
    </div>
    <div class="ov-block">
      <div class="ov-block-title">Behind the Scenes</div>
      <p>${song.behindTheScenes}</p>
    </div>
    ${streamBlock}
  `;

  overlayOpen = true;
  document.getElementById('songOverlay').classList.add('open');
  document.getElementById('universalPlayer').classList.add('hidden');
  document.body.style.overflow = 'hidden';
}

function closeOverlay() {
  overlayOpen = false;
  document.getElementById('songOverlay').classList.remove('open');
  document.getElementById('universalPlayer').classList.remove('hidden');
  document.body.style.overflow = '';
}

document.addEventListener('keydown', e => { if (e.key==='Escape' && overlayOpen) closeOverlay(); });
</script>

</body>
</html>
